import { Injectable } from '@nestjs/common';
import { InjectModel } from '@nestjs/mongoose';
import { ObjectId } from 'mongodb';
import { Model } from 'mongoose';
import { TagCountDto } from './dto/create-tag_count.dto';
import { TagCount, TagCountDocument } from './schemas/tag_count.schema';

@Injectable()
export class TagCountService {
    constructor(
        @InjectModel(TagCount.name, 'SERVER_FULL')
        private readonly tagcountModel: Model<TagCountDocument>,
    ) { }

    async create(
        TagCountDto: TagCountDto,
    ): Promise<TagCount> {
        const tagCountDto = await this.tagcountModel.create(
            TagCountDto,
        );
        return tagCountDto;
    }

    async findAll(): Promise<TagCount[]> {
        return this.tagcountModel.find().exec();
    }

    async findOneById(id: string): Promise<TagCount> {
        return this.tagcountModel
            .findOne({ _id: id })
            .exec();
    }

    async updateData(
        id: string,
        tagCountDto: any,
    ): Promise<TagCount> {
        let data = await this.tagcountModel.findByIdAndUpdate(
            id,
            tagCountDto,
            { new: true },
        );

        if (!data) {
            throw new Error('Todo is not found!');
        }
        return data;
    }

    async update(
        id: string,
        tagCountDto: TagCountDto,
    ): Promise<TagCount> {
        let data = await this.tagcountModel.findByIdAndUpdate(
            id,
            tagCountDto,
            { new: true },
        );

        if (!data) {
            throw new Error('Todo is not found!');
        }
        return data;
    }

    async finddatabypostid(id: string, postid: string) {
        var query = await this.tagcountModel.aggregate([
            {
                $match: {
                    '_id': id
                }
            },
            {
                $unwind: {
                    path: "$listdata",
                    preserveNullAndEmptyArrays: true
                }
            },
            {
                $match: {
                    'listdata.postID': postid
                }
            }
        ]);
        return query;
    }

    // async detailsearchcontenNew(key: string, email: string, skip: number, limit: number, pict: any, vid: any, diary: any) {


    //     var pipeline = [];

    //     pipeline.push({
    //         $match: {
    //             "_id": key
    //         }
    //     },
    //         {
    //             $lookup: {
    //                 from: "posts",
    //                 let: {
    //                     localID: "$listdata.postID"
    //                 },
    //                 pipeline: [
    //                     {
    //                         $match:
    //                         {
    //                             $and: [
    //                                 {
    //                                     $expr: {
    //                                         $in: ['$postID', '$$localID']
    //                                     }
    //                                 },
    //                                 {
    //                                     "reportedStatus": {
    //                                         $ne: "OWNED"
    //                                     }
    //                                 },
    //                                 {
    //                                     "visibility": "PUBLIC"
    //                                 },
    //                                 {
    //                                     "active": true
    //                                 },
    //                                 {
    //                                     "reportedUser.email": {
    //                                         $not: {
    //                                             $regex: email
    //                                         }
    //                                     }
    //                                 },

    //                             ]
    //                         },

    //                     },
    //                     {
    //                         $project: {
    //                             "boosted":
    //                             {
    //                                 $cond: {
    //                                     if: {
    //                                         $gt: [{
    //                                             "$dateToString": {
    //                                                 "format": "%Y-%m-%d %H:%M:%S",
    //                                                 "date": {
    //                                                     $add: [new Date(), 25200000]
    //                                                 }
    //                                             }
    //                                         }, "$boosted.boostSession.timeEnd"]
    //                                     },
    //                                     then: [],
    //                                     else: '$boosted'
    //                                 }
    //                             },
    //                             "reportedStatus": 1,
    //                             "insight": {
    //                                 "shares": "$shares",
    //                                 "comments": "$comments",
    //                                 "views": "$views",
    //                                 "likes": "$likes",

    //                             },
    //                             "comments": "$comments",
    //                             "likes": "$likes",
    //                             "scorePict": 1,
    //                             "_id": 1,
    //                             "postID": 1,
    //                             "createdAt": 1,
    //                             "updatedAt": 1,
    //                             "email": 1,
    //                             "postType": 1,
    //                             "description": 1,
    //                             "active": 1,
    //                             "metadata": 1,
    //                             "location": 1,
    //                             "isOwned": 1,
    //                             "visibility": 1,
    //                             "isViewed": 1,
    //                             "allowComments": 1,
    //                             "saleAmount": 1,
    //                             "isLiked": 1,

    //                         }
    //                     }
    //                 ],
    //                 as: "posted"
    //             },

    //         },);

    //     if (pict === true && vid === false && diary === false) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     "pict":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "pict"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediapicts",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/pict/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "apsaraThumbId": { $arrayElemAt: ['$media.apsaraThumbId', 0] },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                 },

    //             },
    //         );
    //     }

    //     else if (pict === false && vid === true && diary === false) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     "vid":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "vid"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediavideos",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === false && vid === false && diary === true) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     "diary":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "diary"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediadiaries",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === true && vid === false && diary === true) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     "pict":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "pict"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediapicts",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/pict/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "apsaraThumbId": { $arrayElemAt: ['$media.apsaraThumbId', 0] },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                     "diary":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "diary"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediadiaries",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === true && vid === true && diary === true) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     "pict":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "pict"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediapicts",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/pict/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "apsaraThumbId": { $arrayElemAt: ['$media.apsaraThumbId', 0] },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                     "vid":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "vid"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediavideos",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                     "diary":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "diary"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediadiaries",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === false && vid === true && diary === true) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],

    //                     "vid":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "vid"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediavideos",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                     "diary":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "diary"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediadiaries",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === true && vid === true && diary === false) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     "pict":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "pict"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediapicts",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/pict/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "apsaraThumbId": { $arrayElemAt: ['$media.apsaraThumbId', 0] },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],
    //                     "vid":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "vid"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediavideos",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {
    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.postID",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             }, false]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1

    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },

    //                         ],

    //                 },

    //             },
    //         );
    //     }


    //     const query = await this.tagcountModel.aggregate(pipeline);
    //     return query;
    // }

    // async detailsearchcontenNew2(key: string, email: string, skip: number, limit: number, pict: any, vid: any, diary: any) {


    //     var pipeline = [];

    //     pipeline.push({
    //         $match: {
    //             "_id": key
    //         }
    //     },
    //         {
    //             $lookup: {
    //                 from: "posts",
    //                 let: {
    //                     localID: "$listdata.postID"
    //                 },
    //                 pipeline: [
    //                     {
    //                         $match:
    //                         {
    //                             $and: [

    //                                 {
    //                                     $text: {
    //                                         $search: key
    //                                     }
    //                                 },
    //                                 {
    //                                     $expr: {
    //                                         $in: ['$postID', '$$localID']
    //                                     }
    //                                 },
    //                                 {
    //                                     "reportedStatus": {
    //                                         $ne: "OWNED"
    //                                     }
    //                                 },
    //                                 {
    //                                     "visibility": "PUBLIC"
    //                                 },
    //                                 {
    //                                     "active": true
    //                                 },
    //                                 {
    //                                     "reportedUser.email": {
    //                                         $not: {
    //                                             $regex: email
    //                                         }
    //                                     }
    //                                 },

    //                             ]
    //                         },

    //                     },
    //                     {
    //                         $project: {
    //                             "boosted":
    //                             {
    //                                 $cond: {
    //                                     if: {
    //                                         $gt: [{
    //                                             "$dateToString": {
    //                                                 "format": "%Y-%m-%d %H:%M:%S",
    //                                                 "date": {
    //                                                     $add: [new Date(), 25200000]
    //                                                 }
    //                                             }
    //                                         }, "$boosted.boostSession.timeEnd"]
    //                                     },
    //                                     then: [],
    //                                     else: '$boosted'
    //                                 }
    //                             },
    //                             "reportedStatus": 1,
    //                             "insight": {
    //                                 "shares": "$shares",
    //                                 "comments": "$comments",
    //                                 "views": "$views",
    //                                 "likes": "$likes",

    //                             },
    //                             "comments": "$comments",
    //                             "likes": "$likes",
    //                             "_id": 1,
    //                             "postID": 1,
    //                             "createdAt": 1,
    //                             "updatedAt": 1,
    //                             "email": 1,
    //                             "postType": 1,
    //                             "description": 1,
    //                             "active": 1,
    //                             "metadata": 1,
    //                             "location": 1,
    //                             "isOwned": 1,
    //                             "visibility": 1,
    //                             "isViewed": 1,
    //                             "allowComments": 1,
    //                             "saleAmount": 1,
    //                             "isLiked": 1,
    //                             "scorePict": {
    //                                 $meta: "textScore"
    //                             }
    //                         }
    //                     }
    //                 ],
    //                 as: "posted"
    //             },

    //         },);

    //     if (pict === true && vid === false && diary === false) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     //pict
    //                     "pict":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "pict"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediapicts",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/pict/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "uploadSource": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: - 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: - 1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },



    //                         ],
    //                 },

    //             },
    //         );
    //     }

    //     else if (pict === false && vid === true && diary === false) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     "vid":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "vid"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediavideos",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $in: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: - 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: - 1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },

    //                         ],
    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === false && vid === false && diary === true) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     "diary":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "diary"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediadiaries",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $in: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: - 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: - 1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },



    //                         ],

    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === true && vid === false && diary === true) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     //pict
    //                     "pict":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "pict"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediapicts",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/pict/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "uploadSource": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: - 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: - 1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },



    //                         ],
    //                     "diary":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "diary"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediadiaries",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $in: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },


    //                         ],

    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === true && vid === true && diary === true) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     //pict
    //                     "pict":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "pict"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediapicts",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/pict/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "uploadSource": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: - 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: - 1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },



    //                         ],
    //                     "vid":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "vid"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediavideos",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $in: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },

    //                         ],
    //                     "diary":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "diary"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediadiaries",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $in: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },



    //                         ],

    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === false && vid === true && diary === true) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],

    //                     "vid":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "vid"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediavideos",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $in: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },



    //                         ],
    //                     "diary":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "diary"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediadiaries",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $in: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },


    //                         ],

    //                 },

    //             },
    //         );
    //     }
    //     else if (pict === true && vid === true && diary === false) {
    //         pipeline.push(

    //             {
    //                 $facet:
    //                 {
    //                     "tag":
    //                         [
    //                             {
    //                                 $project: {
    //                                     tag: "$_id",
    //                                     total: "$total",
    //                                 }
    //                             }
    //                         ],
    //                     //pict
    //                     "pict":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "pict"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediapicts",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/pict/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "uploadSource": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "apsaraId":
    //                                     {
    //                                         $arrayElemAt: ['$media.apsaraId', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: - 1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: - 1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },



    //                         ],
    //                     "vid":
    //                         [

    //                             {
    //                                 $project: {
    //                                     pict: "$posted"
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$pict"
    //                                 }
    //                             },
    //                             {
    //                                 $match: {
    //                                     "pict.postType": "vid"
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediavideos",
    //                                     as: "media",
    //                                     let: {
    //                                         localID: '$pict.postID'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $in: ['$postID', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "apsara": 1,
    //                                                 "apsaraId": 1,
    //                                                 "apsaraThumbId": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/stream/", "$postID"]
    //                                                 },
    //                                                 "mediaUri": 1,
    //                                                 "mediaThumbEndpoint": {
    //                                                     "$concat": ["/thumb/", "$postID"]
    //                                                 },
    //                                                 "mediaThumbUri": 1,
    //                                                 "mediaType": 1,

    //                                             }
    //                                         }
    //                                     ],

    //                                 },

    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": "$pict.scorePict",
    //                                     "boosted": "$pict.boosted",
    //                                     "reportedStatus": "$pict.reportedStatus",
    //                                     "_id": "$pict._id",
    //                                     "mediaThumbEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaThumbEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaEndpoint":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaEndpoint', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "mediaType":
    //                                     {
    //                                         $arrayElemAt: ['$media.mediaType', {
    //                                             "$indexOfArray": [
    //                                                 "$media.postID",
    //                                                 "$pict.postID"
    //                                             ]
    //                                         }]
    //                                     },
    //                                     "createdAt": "$pict.createdAt",
    //                                     "updatedAt": "$pict.updatedAt",
    //                                     "postID": "$pict.postID",
    //                                     "email": "$pict.email",
    //                                     "postType": "$pict.postType",
    //                                     "description": "$pict.description",
    //                                     "active": "$pict.active",
    //                                     "metadata": "$pict.metadata",
    //                                     "location": "$pict.location",
    //                                     "isOwned": "$pict.isOwned",
    //                                     "visibility": "$pict.visibility",
    //                                     "isViewed": "$pict.isViewed",
    //                                     "allowComments": "$pict.allowComments",
    //                                     "saleAmount": "$pict.saleAmount",
    //                                     "uploadSource": "$media.uploadSource",
    //                                     "monetize":
    //                                     {
    //                                         $cond: {
    //                                             if: {
    //                                                 $gte: ["$pict.saleAmount", 1]
    //                                             },
    //                                             then: true,
    //                                             else: "$taslimKONAG"
    //                                         }
    //                                     },
    //                                     "comments": "$pict.comments",
    //                                     "likes": "$pict.likes",
    //                                     "viewed": "$pict.insight.views",
    //                                     "insight":
    //                                     {
    //                                         $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
    //                                     },
    //                                     "isApsara":
    //                                     {
    //                                         $ifNull: [
    //                                             {
    //                                                 $arrayElemAt: ['$media.apsara', {
    //                                                     "$indexOfArray": [
    //                                                         "$media.postID",
    //                                                         "$pict.postID"
    //                                                     ]
    //                                                 }]
    //                                             },
    //                                             false
    //                                         ]
    //                                     },
    //                                     "apsaraThumbId": {
    //                                         $arrayElemAt: ['$media.apsaraThumbId', 0]
    //                                     },
    //                                     "viewer": "$pict.viewer",
    //                                     "musicId": "$pict.musicId",
    //                                     "category": "$pict.category",
    //                                     "contentModeration": "$pict.contentModeration",
    //                                     "reportedUserCount": "$pict.reportedUserCount",
    //                                     "contentModerationResponse": "$pict.contentModerationResponse",
    //                                     "reportedUser": "$pict.reportedUser",
    //                                     "tags": "$pict.tags"
    //                                 }
    //                             },
    //                             {
    //                                 $sort: {
    //                                     isApsara: -1,
    //                                     scorePict: - 1,
    //                                     comments: - 1,
    //                                     likes: - 1,
    //                                     createdAt: -1
    //                                 }
    //                             },
    //                             {
    //                                 $skip: skip
    //                             },
    //                             {
    //                                 $limit: limit
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "friend_list",
    //                                     as: "friend",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $or: [
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$localID']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": email
    //                                                             }
    //                                                         ]
    //                                                     },
    //                                                     {
    //                                                         $and: [
    //                                                             {
    //                                                                 $expr: {
    //                                                                     $eq: ['$email', '$$user']
    //                                                                 }
    //                                                             },
    //                                                             {
    //                                                                 "friendlist.email": '$.email'
    //                                                             }
    //                                                         ]
    //                                                     }
    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 friend:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $size: '$friendlist'
    //                                                             }, 0]
    //                                                         },
    //                                                         then: 1,
    //                                                         else: 0
    //                                                     }
    //                                                 },

    //                                             }
    //                                         },

    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "username",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {


    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userBasic",
    //                                     let: {
    //                                         localID: '$email'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$email', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "fullName": 1,
    //                                                 "profilePict": 1,
    //                                                 "isCelebrity": 1,
    //                                                 "isIdVerified": 1,
    //                                                 "isPrivate": 1,
    //                                                 "isFollowPrivate": 1,
    //                                                 "isPostPrivate": 1,
    //                                                 "urluserBadge":
    //                                                 {
    //                                                     "$filter":
    //                                                     {
    //                                                         input: "$userBadge",
    //                                                         as: "listbadge",
    //                                                         cond:
    //                                                         {
    //                                                             "$and":
    //                                                                 [
    //                                                                     {
    //                                                                         "$eq":
    //                                                                             [
    //                                                                                 "$$listbadge.isActive", true
    //                                                                             ]
    //                                                                     },
    //                                                                     {
    //                                                                         "$lte": [
    //                                                                             {
    //                                                                                 "$dateToString": {
    //                                                                                     "format": "%Y-%m-%d %H:%M:%S",
    //                                                                                     "date": {
    //                                                                                         "$add": [
    //                                                                                             new Date(),
    //                                                                                             25200000
    //                                                                                         ]
    //                                                                                     }
    //                                                                                 }
    //                                                                             },
    //                                                                             "$$listbadge.endDatetime"
    //                                                                         ]
    //                                                                     }
    //                                                                 ]
    //                                                         }
    //                                                     }
    //                                                 },
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userBasic",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $set: {
    //                                     kosong: {
    //                                         $ifNull: ['$userBasic.profilePict.$id', "kancut"]
    //                                     }
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediaprofilepicts",
    //                                     as: "avatar",
    //                                     let: {
    //                                         localID: '$kosong'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$mediaID', "$$localID"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "mediaBasePath": 1,
    //                                                 "mediaUri": 1,
    //                                                 "originalName": 1,
    //                                                 "fsSourceUri": 1,
    //                                                 "fsSourceName": 1,
    //                                                 "fsTargetUri": 1,
    //                                                 "mediaType": 1,
    //                                                 "mediaEndpoint": {
    //                                                     "$concat": ["/profilepict/", "$mediaID"]
    //                                                 }
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$avatar",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "isLike",
    //                                     let: {
    //                                         picts: '$postID',

    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$postID', '$$picts']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "eventType": "LIKE"
    //                                                     },
    //                                                     {
    //                                                         "event": "DONE"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },
    //                                                     {
    //                                                         "email": email

    //                                                     },

    //                                                 ]
    //                                             },

    //                                         },
    //                                         {
    //                                             $set: {
    //                                                 kancut: {
    //                                                     $ifNull: ["email", "kosong"]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "email": 1,
    //                                                 "postID": 1,
    //                                                 isLiked:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $eq: ["$kancut", "kosong"]
    //                                                         },
    //                                                         then: false,
    //                                                         else: true
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "contentevents",
    //                                     as: "following",
    //                                     let: {
    //                                         localID: '$email',
    //                                         user: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $and: [
    //                                                     {
    //                                                         $expr: {
    //                                                             $eq: ['$senderParty', '$$localID']
    //                                                         }
    //                                                     },
    //                                                     {
    //                                                         "email": email
    //                                                     },
    //                                                     {
    //                                                         "eventType": "FOLLOWING",

    //                                                     },
    //                                                     {
    //                                                         "event": "ACCEPT"
    //                                                     },
    //                                                     {
    //                                                         "active": true
    //                                                     },

    //                                                 ]
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 following:
    //                                                 {
    //                                                     $cond: {
    //                                                         if: {
    //                                                             $gt: [{
    //                                                                 $strLenCP: "$email"
    //                                                             }, 0]
    //                                                         },
    //                                                         then: true,
    //                                                         else: false
    //                                                     }
    //                                                 },

    //                                             }
    //                                         }
    //                                     ]
    //                                 },

    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "interests_repo",
    //                                     as: "cats",
    //                                     let: {
    //                                         localID: '$category.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {

    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $in: ['$_id', {
    //                                                                 $ifNull: ['$$localID', []]
    //                                                             }]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "interestName": 1,
    //                                                 "langIso": 1,
    //                                                 "icon": 1,
    //                                                 "createdAt": 1,
    //                                                 "updatedAt": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userbasics",
    //                                     as: "userInterest",
    //                                     let: {
    //                                         localID: email
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match: {
    //                                                 $expr: {
    //                                                     $and: [
    //                                                         {
    //                                                             $eq: ["$email", "$$localID"]
    //                                                         },

    //                                                     ]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 userInterests: "$userInterests.$id",
    //                                                 email: 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "userauths",
    //                                     as: "userTag",
    //                                     let: {
    //                                         localID: '$tagPeople.$id'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $in: ['$_id', {
    //                                                         $ifNull: ['$$localID', []]
    //                                                     }]
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {

    //                                                 "username": 1
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 "$lookup": {
    //                                     from: "mediamusic",
    //                                     as: "music",
    //                                     let: {
    //                                         localID: '$musicId'
    //                                     },
    //                                     pipeline: [
    //                                         {
    //                                             $match:
    //                                             {
    //                                                 $expr: {
    //                                                     $eq: ['$_id', '$$localID']
    //                                                 }
    //                                             }
    //                                         },
    //                                         {
    //                                             $project: {
    //                                                 "musicTitle": 1,
    //                                                 "artistName": 1,
    //                                                 "albumName": 1,
    //                                                 "apsaraMusic": 1,
    //                                                 "apsaraThumnail": 1,
    //                                                 "genre": "$genre.name",
    //                                                 "theme": "$theme.name",
    //                                                 "mood": "$mood.name",

    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$genre",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$theme",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         },
    //                                         {
    //                                             $unwind: {
    //                                                 path: "$mood",
    //                                                 preserveNullAndEmptyArrays: true
    //                                             }
    //                                         }
    //                                     ],

    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$media",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$username",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$music",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $unwind: {
    //                                     path: "$userInterest",
    //                                     preserveNullAndEmptyArrays: true
    //                                 }
    //                             },
    //                             {
    //                                 $project: {

    //                                     "scorePict": 1,
    //                                     "boosted": 1,
    //                                     "reportedStatus": 1,
    //                                     "_id": 1,
    //                                     "mediaThumbEndpoint": 1,
    //                                     "mediaEndpoint": 1,
    //                                     "mediaType": 1,
    //                                     "createdAt": 1,
    //                                     "updatedAt": 1,
    //                                     "postID": 1,
    //                                     "email": 1,
    //                                     "postType": 1,
    //                                     "description": 1,
    //                                     "active": 1,
    //                                     "metadata": 1,
    //                                     "location": 1,
    //                                     "isOwned": 1,
    //                                     "visibility": 1,
    //                                     "isViewed": 1,
    //                                     "allowComments": 1,
    //                                     "saleAmount": 1,
    //                                     "uploadSource": 1,
    //                                     "monetize": 1,
    //                                     "comments": 1,
    //                                     "likes": 1,
    //                                     "viewed": 1,
    //                                     "insight": 1,
    //                                     "apsaraId": 1,
    //                                     "isApsara": 1,
    //                                     "apsaraThumbId": 1,
    //                                     "viewer": 1,
    //                                     "fullName": "$userBasic.fullName",
    //                                     "username": "$username.username",
    //                                     "avatar": 1,
    //                                     "urluserBadge":
    //                                     {
    //                                         "$ifNull":
    //                                             [
    //                                                 {
    //                                                     "$arrayElemAt":
    //                                                         [
    //                                                             "$userBasic.urluserBadge", 0
    //                                                         ]
    //                                                 },
    //                                                 null
    //                                             ]
    //                                     },
    //                                     isLiked: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$isLike.isLiked", 0]
    //                                         }, false]
    //                                     },
    //                                     "privacy": {
    //                                         "isCelebrity": "$userBasic.isCelebrity",
    //                                         "isIdVerified": "$userBasic.isIdVerified",
    //                                         "isPrivate": "$userBasic.isPrivate",
    //                                         "isFollowPrivate": "$userBasic.isFollowPrivate",
    //                                         "isPostPrivate": "$userBasic.isPostPrivate",

    //                                     },
    //                                     "verified": "$userBasic.isIdVerified",
    //                                     friend: {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$friend.friend", 0]
    //                                         }, 0]
    //                                     },
    //                                     "following": {
    //                                         $ifNull: [{
    //                                             $arrayElemAt: ["$following.following", 0]
    //                                         }, false]
    //                                     },
    //                                     "musicTitle": "$music.musicTitle",
    //                                     "artistName": "$music.artistName",
    //                                     "albumName": "$music.albumName",
    //                                     "apsaraMusic": "$music.apsaraMusic",
    //                                     "apsaraThumnail": "$music.apsaraThumnail",
    //                                     "genre": "$music.genre.name",
    //                                     "theme": "$music.theme.name",
    //                                     "mood": "$music.mood.name",
    //                                     "testDate": 1,
    //                                     "musicId": 1,
    //                                     "music": 1,
    //                                     "tagPeople": "$userTag",
    //                                     "cats": "$cats",
    //                                     "contentModeration": 1,
    //                                     "reportedUserCount": 1,
    //                                     "contentModerationResponse": 1,
    //                                     "reportedUser": 1,
    //                                     "tags": 1
    //                                 }
    //                             },


    //                         ],

    //                 },

    //             },
    //         );
    //     }


    //     const query = await this.tagcountModel.aggregate(pipeline);
    //     return query;
    // }
    async listag(tag: string) {
        var pipeline = [];
        pipeline.push(
            {
                $match: {
                    _id: {
                        $regex: tag,
                        $options: 'i'
                    },

                }
            },
            {
                "$unwind": {
                    "path": "$listdata",
                    "preserveNullAndEmptyArrays": false
                }
            },
            {
                $project: {
                    _id: 1,
                    postID: "$listdata.postID"
                }
            },
            {
                $lookup: {
                    from: 'posts',
                    localField: 'postID',
                    foreignField: '_id',
                    as: 'post_data',

                },

            },
            {
                $project: {
                    _id: 1,
                    postID: 1,
                    postType: {
                        $arrayElemAt: ['$post_data.postType', 0]
                    },
                    email: {
                        $arrayElemAt: ['$post_data.email', 0]
                    },

                }
            },
            {
                $lookup: {
                    from: 'userbasics',
                    localField: 'email',
                    foreignField: 'email',
                    as: 'databasic',

                },

            },
            {
                $project: {
                    _id: 1,
                    postID: 1,
                    postType: 1,
                    email: 1,
                    iduser: {
                        $arrayElemAt: ['$databasic._id', 0]
                    },

                }
            },
        );
        var query = await this.tagcountModel.aggregate(pipeline);
        return query;
    }

    async detailsearchcontenNew(key: string, email: string, skip: number, limit: number, pict: any, vid: any, diary: any) {


        var pipeline = [];

        pipeline.push({
            $match: {
                "_id": key
            }
        },
            {
                $lookup: {
                    from: "posts",
                    let: {
                        localID: "$listdata.postID"
                    },
                    pipeline: [
                        {
                            $match:
                            {
                                $and: [

                                    {
                                        $text: {
                                            $search: key
                                        }
                                    },
                                    {
                                        $expr: {
                                            $in: ['$postID', '$$localID']
                                        }
                                    },
                                    {
                                        "reportedStatus": {
                                            $ne: "OWNED"
                                        }
                                    },
                                    {
                                        "visibility": "PUBLIC"
                                    },
                                    {
                                        "active": true
                                    },
                                    {
                                        "reportedUser.email": {
                                            $not: {
                                                $regex: email
                                            }
                                        }
                                    },

                                ]
                            },

                        },
                        {
                            $project: {
                                "boosted":
                                {
                                    $cond: {
                                        if: {
                                            $gt: [{
                                                "$dateToString": {
                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                    "date": {
                                                        $add: [new Date(), 25200000]
                                                    }
                                                }
                                            }, "$boosted.boostSession.timeEnd"]
                                        },
                                        then: [],
                                        else: '$boosted'
                                    }
                                },
                                "reportedStatus": 1,
                                "insight": {
                                    "shares": "$shares",
                                    "comments": "$comments",
                                    "views": "$views",
                                    "likes": "$likes",

                                },
                                "comments": "$comments",
                                "likes": "$likes",
                                "_id": 1,
                                "postID": 1,
                                "createdAt": 1,
                                "updatedAt": 1,
                                "email": 1,
                                "postType": 1,
                                "description": 1,
                                "active": 1,
                                "metadata": 1,
                                "location": 1,
                                "isOwned": 1,
                                "visibility": 1,
                                "isViewed": 1,
                                "allowComments": 1,
                                "saleAmount": 1,
                                "isLiked": 1,
                                "scorePict": {
                                    $meta: "textScore"
                                }
                            }
                        }
                    ],
                    as: "posted"
                },

            },);

        if (pict === true && vid === false && diary === false) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        "pict":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "pict"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediapicts",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/pict/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,
                                                    "uploadSource": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        },
                                        "apsaraThumbId": { $arrayElemAt: ['$media.apsaraThumbId', 0] },
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1

                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                    },

                },
            );
        }

        else if (pict === false && vid === true && diary === false) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        "vid":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "vid"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediavideos",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        }
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1

                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                    },

                },
            );
        }
        else if (pict === false && vid === false && diary === true) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        "diary":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "diary"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediadiaries",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        }
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                    },

                },
            );
        }
        else if (pict === true && vid === false && diary === true) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        "pict":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "pict"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediapicts",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/pict/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,
                                                    "uploadSource": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        },
                                        "apsaraThumbId": { $arrayElemAt: ['$media.apsaraThumbId', 0] },
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1

                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                        "diary":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "diary"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediadiaries",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        }
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                    },

                },
            );
        }
        else if (pict === true && vid === true && diary === true) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        "pict":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "pict"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediapicts",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/pict/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,
                                                    "uploadSource": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        },
                                        "apsaraThumbId": { $arrayElemAt: ['$media.apsaraThumbId', 0] },
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1

                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                        "vid":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "vid"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediavideos",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        }
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1

                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                        "diary":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "diary"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediadiaries",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        }
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                    },

                },
            );
        }
        else if (pict === false && vid === true && diary === true) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],

                        "vid":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "vid"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediavideos",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        }
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1

                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                        "diary":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "diary"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediadiaries",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        }
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                    },

                },
            );
        }
        else if (pict === true && vid === true && diary === false) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        "pict":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "pict"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediapicts",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/pict/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,
                                                    "uploadSource": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        },
                                        "apsaraThumbId": { $arrayElemAt: ['$media.apsaraThumbId', 0] },
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1

                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],
                        "vid":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "vid"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediavideos",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {
                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                }, false]
                                        }
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1

                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },

                            ],

                    },

                },
            );
        }


        const query = await this.tagcountModel.aggregate(pipeline);
        return query;
    }

    async detailsearchcontenNew2(key: string, email: string, skip: number, limit: number, pict: any, vid: any, diary: any) {


        var pipeline = [];

        pipeline.push({
            $match: {
                "_id": key
            }
        },
            {
                $lookup: {
                    from: "posts",
                    let: {
                        localID: "$listdata.postID"
                    },
                    pipeline: [
                        {
                            $match:
                            {
                                $and: [

                                    {
                                        $text: {
                                            $search: key
                                        }
                                    },
                                    {
                                        $expr: {
                                            $in: ['$postID', '$$localID']
                                        }
                                    },
                                    {
                                        "reportedStatus": {
                                            $ne: "OWNED"
                                        }
                                    },
                                    {
                                        "visibility": "PUBLIC"
                                    },
                                    {
                                        "active": true
                                    },
                                    {
                                        "reportedUser.email": {
                                            $not: {
                                                $regex: email
                                            }
                                        }
                                    },

                                ]
                            },

                        },
                        {
                            $project: {
                                "boosted":
                                {
                                    $cond: {
                                        if: {
                                            $gt: [{
                                                "$dateToString": {
                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                    "date": {
                                                        $add: [new Date(), 25200000]
                                                    }
                                                }
                                            }, "$boosted.boostSession.timeEnd"]
                                        },
                                        then: [],
                                        else: '$boosted'
                                    }
                                },
                                "reportedStatus": 1,
                                "insight": {
                                    "shares": "$shares",
                                    "comments": "$comments",
                                    "views": "$views",
                                    "likes": "$likes",

                                },
                                "comments": "$comments",
                                "likes": "$likes",
                                "_id": 1,
                                "postID": 1,
                                "createdAt": 1,
                                "updatedAt": 1,
                                "email": 1,
                                "postType": 1,
                                "description": 1,
                                "active": 1,
                                "metadata": 1,
                                "location": 1,
                                "isOwned": 1,
                                "visibility": 1,
                                "isViewed": 1,
                                "allowComments": 1,
                                "saleAmount": 1,
                                "isLiked": 1,
                                "scorePict": {
                                    $meta: "textScore"
                                }
                            }
                        }
                    ],
                    as: "posted"
                },

            },);

        if (pict === true && vid === false && diary === false) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        //pict
                        "pict":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "pict"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediapicts",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/pict/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,
                                                    "uploadSource": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: - 1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: - 1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },



                            ],
                    },

                },
            );
        }

        else if (pict === false && vid === true && diary === false) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        "vid":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "vid"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediavideos",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: - 1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: - 1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },

                            ],
                    },

                },
            );
        }
        else if (pict === false && vid === false && diary === true) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        "diary":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "diary"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediadiaries",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: - 1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: - 1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },



                            ],

                    },

                },
            );
        }
        else if (pict === true && vid === false && diary === true) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        //pict
                        "pict":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "pict"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediapicts",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/pict/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,
                                                    "uploadSource": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: - 1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: - 1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },



                            ],
                        "diary":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "diary"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediadiaries",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },


                            ],

                    },

                },
            );
        }
        else if (pict === true && vid === true && diary === true) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        //pict
                        "pict":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "pict"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediapicts",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/pict/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,
                                                    "uploadSource": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: - 1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: - 1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },



                            ],
                        "vid":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "vid"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediavideos",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },

                            ],
                        "diary":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "diary"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediadiaries",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },



                            ],

                    },

                },
            );
        }
        else if (pict === false && vid === true && diary === true) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],

                        "vid":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "vid"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediavideos",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },



                            ],
                        "diary":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "diary"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediadiaries",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },


                            ],

                    },

                },
            );
        }
        else if (pict === true && vid === true && diary === false) {
            pipeline.push(

                {
                    $facet:
                    {
                        "tag":
                            [
                                {
                                    $project: {
                                        tag: "$_id",
                                        total: "$total",
                                    }
                                }
                            ],
                        //pict
                        "pict":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "pict"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediapicts",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/pict/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,
                                                    "uploadSource": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "apsaraId":
                                        {
                                            $arrayElemAt: ['$media.apsaraId', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: - 1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: - 1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },



                            ],
                        "vid":
                            [

                                {
                                    $project: {
                                        pict: "$posted"
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$pict"
                                    }
                                },
                                {
                                    $match: {
                                        "pict.postType": "vid"
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediavideos",
                                        as: "media",
                                        let: {
                                            localID: '$pict.postID'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$postID', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "apsara": 1,
                                                    "apsaraId": 1,
                                                    "apsaraThumbId": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/stream/", "$postID"]
                                                    },
                                                    "mediaUri": 1,
                                                    "mediaThumbEndpoint": {
                                                        "$concat": ["/thumb/", "$postID"]
                                                    },
                                                    "mediaThumbUri": 1,
                                                    "mediaType": 1,

                                                }
                                            }
                                        ],

                                    },

                                },
                                {
                                    $project: {

                                        "scorePict": "$pict.scorePict",
                                        "boosted": "$pict.boosted",
                                        "reportedStatus": "$pict.reportedStatus",
                                        "_id": "$pict._id",
                                        "mediaThumbEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaThumbEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaEndpoint":
                                        {
                                            $arrayElemAt: ['$media.mediaEndpoint', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "mediaType":
                                        {
                                            $arrayElemAt: ['$media.mediaType', {
                                                "$indexOfArray": [
                                                    "$media.postID",
                                                    "$pict.postID"
                                                ]
                                            }]
                                        },
                                        "createdAt": "$pict.createdAt",
                                        "updatedAt": "$pict.updatedAt",
                                        "postID": "$pict.postID",
                                        "email": "$pict.email",
                                        "postType": "$pict.postType",
                                        "description": "$pict.description",
                                        "active": "$pict.active",
                                        "metadata": "$pict.metadata",
                                        "location": "$pict.location",
                                        "isOwned": "$pict.isOwned",
                                        "visibility": "$pict.visibility",
                                        "isViewed": "$pict.isViewed",
                                        "allowComments": "$pict.allowComments",
                                        "saleAmount": "$pict.saleAmount",
                                        "uploadSource": "$media.uploadSource",
                                        "monetize":
                                        {
                                            $cond: {
                                                if: {
                                                    $gte: ["$pict.saleAmount", 1]
                                                },
                                                then: true,
                                                else: "$taslimKONAG"
                                            }
                                        },
                                        "comments": "$pict.comments",
                                        "likes": "$pict.likes",
                                        "viewed": "$pict.insight.views",
                                        "insight":
                                        {
                                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                                        },
                                        "isApsara":
                                        {
                                            $ifNull: [
                                                {
                                                    $arrayElemAt: ['$media.apsara', {
                                                        "$indexOfArray": [
                                                            "$media.postID",
                                                            "$pict.postID"
                                                        ]
                                                    }]
                                                },
                                                false
                                            ]
                                        },
                                        "apsaraThumbId": {
                                            $arrayElemAt: ['$media.apsaraThumbId', 0]
                                        },
                                        "viewer": "$pict.viewer",
                                        "musicId": "$pict.musicId",
                                        "category": "$pict.category",
                                        "contentModeration": "$pict.contentModeration",
                                        "reportedUserCount": "$pict.reportedUserCount",
                                        "contentModerationResponse": "$pict.contentModerationResponse",
                                        "reportedUser": "$pict.reportedUser",
                                        "tags": "$pict.tags"
                                    }
                                },
                                {
                                    $sort: {
                                        isApsara: -1,
                                        scorePict: - 1,
                                        comments: - 1,
                                        likes: - 1,
                                        createdAt: -1
                                    }
                                },
                                {
                                    $skip: skip
                                },
                                {
                                    $limit: limit
                                },
                                {
                                    "$lookup": {
                                        from: "friend_list",
                                        as: "friend",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $or: [
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$localID']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": email
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            $and: [
                                                                {
                                                                    $expr: {
                                                                        $eq: ['$email', '$$user']
                                                                    }
                                                                },
                                                                {
                                                                    "friendlist.email": '$.email'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    friend:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $size: '$friendlist'
                                                                }, 0]
                                                            },
                                                            then: 1,
                                                            else: 0
                                                        }
                                                    },

                                                }
                                            },

                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "username",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {


                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userBasic",
                                        let: {
                                            localID: '$email'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$email', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "fullName": 1,
                                                    "profilePict": 1,
                                                    "isCelebrity": 1,
                                                    "isIdVerified": 1,
                                                    "isPrivate": 1,
                                                    "isFollowPrivate": 1,
                                                    "isPostPrivate": 1,
                                                    "urluserBadge":
                                                    {
                                                        "$ifNull":
                                                            [
                                                                {
                                                                    "$filter":
                                                                    {
                                                                        input: "$userBadge",
                                                                        as: "listbadge",
                                                                        cond:
                                                                        {
                                                                            "$and":
                                                                                [
                                                                                    {
                                                                                        "$eq":
                                                                                            [
                                                                                                "$$listbadge.isActive", true
                                                                                            ]
                                                                                    },
                                                                                    {
                                                                                        "$lte": [
                                                                                            {
                                                                                                "$dateToString": {
                                                                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                                                                    "date": {
                                                                                                        "$add": [
                                                                                                            new Date(),
                                                                                                            25200000
                                                                                                        ]
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "$$listbadge.endDatetime"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                        }
                                                                    },
                                                                },
                                                                []
                                                            ]
                                                    },
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userBasic",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $set: {
                                        kosong: {
                                            $ifNull: ['$userBasic.profilePict.$id', "kancut"]
                                        }
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediaprofilepicts",
                                        as: "avatar",
                                        let: {
                                            localID: '$kosong'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$mediaID', "$$localID"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "mediaBasePath": 1,
                                                    "mediaUri": 1,
                                                    "originalName": 1,
                                                    "fsSourceUri": 1,
                                                    "fsSourceName": 1,
                                                    "fsTargetUri": 1,
                                                    "mediaType": 1,
                                                    "mediaEndpoint": {
                                                        "$concat": ["/profilepict/", "$mediaID"]
                                                    }
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$avatar",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "isLike",
                                        let: {
                                            picts: '$postID',

                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$postID', '$$picts']
                                                            }
                                                        },
                                                        {
                                                            "eventType": "LIKE"
                                                        },
                                                        {
                                                            "event": "DONE"
                                                        },
                                                        {
                                                            "active": true
                                                        },
                                                        {
                                                            "email": email

                                                        },

                                                    ]
                                                },

                                            },
                                            {
                                                $set: {
                                                    kancut: {
                                                        $ifNull: ["email", "kosong"]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "email": 1,
                                                    "postID": 1,
                                                    isLiked:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $eq: ["$kancut", "kosong"]
                                                            },
                                                            then: false,
                                                            else: true
                                                        }
                                                    },

                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "contentevents",
                                        as: "following",
                                        let: {
                                            localID: '$email',
                                            user: email
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $and: [
                                                        {
                                                            $expr: {
                                                                $eq: ['$senderParty', '$$localID']
                                                            }
                                                        },
                                                        {
                                                            "email": email
                                                        },
                                                        {
                                                            "eventType": "FOLLOWING",

                                                        },
                                                        {
                                                            "event": "ACCEPT"
                                                        },
                                                        {
                                                            "active": true
                                                        },

                                                    ]
                                                }
                                            },
                                            {
                                                $project: {
                                                    following:
                                                    {
                                                        $cond: {
                                                            if: {
                                                                $gt: [{
                                                                    $strLenCP: "$email"
                                                                }, 0]
                                                            },
                                                            then: true,
                                                            else: false
                                                        }
                                                    },

                                                }
                                            }
                                        ]
                                    },

                                },
                                {
                                    "$lookup": {
                                        from: "interests_repo",
                                        as: "cats",
                                        let: {
                                            localID: '$category.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match: {

                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $in: ['$_id', {
                                                                    $ifNull: ['$$localID', []]
                                                                }]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "interestName": 1,
                                                    "langIso": 1,
                                                    "icon": 1,
                                                    "createdAt": 1,
                                                    "updatedAt": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userbasics",
                                        as: "userInterest",
                                        let: {
                                            localID: email
                                        },
                                        pipeline: [
                                            {
                                                $match: {
                                                    $expr: {
                                                        $and: [
                                                            {
                                                                $eq: ["$email", "$$localID"]
                                                            },

                                                        ]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    userInterests: "$userInterests.$id",
                                                    email: 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "userauths",
                                        as: "userTag",
                                        let: {
                                            localID: '$tagPeople.$id'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $in: ['$_id', {
                                                            $ifNull: ['$$localID', []]
                                                        }]
                                                    }
                                                }
                                            },
                                            {
                                                $project: {

                                                    "username": 1
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    "$lookup": {
                                        from: "mediamusic",
                                        as: "music",
                                        let: {
                                            localID: '$musicId'
                                        },
                                        pipeline: [
                                            {
                                                $match:
                                                {
                                                    $expr: {
                                                        $eq: ['$_id', '$$localID']
                                                    }
                                                }
                                            },
                                            {
                                                $project: {
                                                    "musicTitle": 1,
                                                    "artistName": 1,
                                                    "albumName": 1,
                                                    "apsaraMusic": 1,
                                                    "apsaraThumnail": 1,
                                                    "genre": "$genre.name",
                                                    "theme": "$theme.name",
                                                    "mood": "$mood.name",

                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$genre",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$theme",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            },
                                            {
                                                $unwind: {
                                                    path: "$mood",
                                                    preserveNullAndEmptyArrays: true
                                                }
                                            }
                                        ],

                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$media",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$username",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$music",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $unwind: {
                                        path: "$userInterest",
                                        preserveNullAndEmptyArrays: true
                                    }
                                },
                                {
                                    $project: {

                                        "scorePict": 1,
                                        "boosted": 1,
                                        "reportedStatus": 1,
                                        "_id": 1,
                                        "mediaThumbEndpoint": 1,
                                        "mediaEndpoint": 1,
                                        "mediaType": 1,
                                        "createdAt": 1,
                                        "updatedAt": 1,
                                        "postID": 1,
                                        "email": 1,
                                        "postType": 1,
                                        "description": 1,
                                        "active": 1,
                                        "metadata": 1,
                                        "location": 1,
                                        "isOwned": 1,
                                        "visibility": 1,
                                        "isViewed": 1,
                                        "allowComments": 1,
                                        "saleAmount": 1,
                                        "uploadSource": 1,
                                        "monetize": 1,
                                        "comments": 1,
                                        "likes": 1,
                                        "viewed": 1,
                                        "insight": 1,
                                        "apsaraId": 1,
                                        "isApsara": 1,
                                        "apsaraThumbId": 1,
                                        "viewer": 1,
                                        "fullName": "$userBasic.fullName",
                                        "username": "$username.username",
                                        "avatar": 1,
                                        "urluserBadge":
                                        {
                                            "$ifNull":
                                                [
                                                    {
                                                        "$arrayElemAt":
                                                            [
                                                                "$userBasic.urluserBadge", 0
                                                            ]
                                                    },
                                                    null
                                                ]
                                        },
                                        isLiked: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$isLike.isLiked", 0]
                                            }, false]
                                        },
                                        "privacy": {
                                            "isCelebrity": "$userBasic.isCelebrity",
                                            "isIdVerified": "$userBasic.isIdVerified",
                                            "isPrivate": "$userBasic.isPrivate",
                                            "isFollowPrivate": "$userBasic.isFollowPrivate",
                                            "isPostPrivate": "$userBasic.isPostPrivate",

                                        },
                                        "verified": "$userBasic.isIdVerified",
                                        friend: {
                                            $ifNull: [{
                                                $arrayElemAt: ["$friend.friend", 0]
                                            }, 0]
                                        },
                                        "following": {
                                            $ifNull: [{
                                                $arrayElemAt: ["$following.following", 0]
                                            }, false]
                                        },
                                        "musicTitle": "$music.musicTitle",
                                        "artistName": "$music.artistName",
                                        "albumName": "$music.albumName",
                                        "apsaraMusic": "$music.apsaraMusic",
                                        "apsaraThumnail": "$music.apsaraThumnail",
                                        "genre": "$music.genre.name",
                                        "theme": "$music.theme.name",
                                        "mood": "$music.mood.name",
                                        "testDate": 1,
                                        "musicId": 1,
                                        "music": 1,
                                        "tagPeople": "$userTag",
                                        "cats": "$cats",
                                        "contentModeration": 1,
                                        "reportedUserCount": 1,
                                        "contentModerationResponse": 1,
                                        "reportedUser": 1,
                                        "tags": 1
                                    }
                                },



                            ],

                    },

                },
            );
        }


        const query = await this.tagcountModel.aggregate(pipeline);
        return query;
    }

    async detailsearchcontenNew3(key: string, email: string, skip: number, limit: number, pict: any, vid: any, diary: any) 
    {
        var pipeline = [];
        pipeline.push(
            {
                $match: {
                    "_id": key
                }
            },
            {
                $lookup: {
                    from: "newPosts",
                    let: {
                        localID: "$listdata.postID"
                    },
                    pipeline: [
                        {
                            $match: 
                            {
                                $and: [
                                    {
                                        $expr: {
                                            $in: ['$postID', '$$localID']
                                        }
                                    },
                                    {
                                        "reportedStatus": {
                                            $ne: "OWNED"
                                        }
                                    },
                                    {
                                        "visibility": "PUBLIC"
                                    },
                                    {
                                        "active": true
                                    },
                                    {
                                        "reportedUser.email": {
                                            $not: {
                                                $regex: email
                                            }
                                        }
                                    },
                                    { '$text': { '$search': key } }
                                ]
                            },
                            
                        },
                        {
                            $project: {
                                "boosted": 
                                {
                                    $cond: {
                                        if : {
                                            $gt: [{
                                                "$dateToString": {
                                                    "format": "%Y-%m-%d %H:%M:%S",
                                                    "date": {
                                                        $add: [new Date(), 25200000]
                                                    }
                                                }
                                            }, "$boosted.boostSession.timeEnd"]
                                        },
                                        then: [],
                                        else : '$boosted'
                                    }
                                },
                                "reportedStatus": 1,
                                "insight": {
                                    "shares": "$shares",
                                    "comments": "$comments",
                                    "views": "$views",
                                    "likes": "$likes",
                                    
                                },
                                "comments": "$comments",
                                "likes": "$likes",
                                "scorePict": { '$meta': 'textScore' },
                                "_id": 1,
                                "postID": 1,
                                "createdAt": 1,
                                "updatedAt": 1,
                                "email": 1,
                                "postType": 1,
                                "description": 1,
                                "active": 1,
                                "metadata": 1,
                                "location": 1,
                                "isOwned": 1,
                                "visibility": 1,
                                "isViewed": 1,
                                "allowComments": 1,
                                "saleAmount": 1,
                                "isLiked": 1,
                                "mediaSource": 1,   
                            }
                        }
                    ],
                    as: "posted"
                },
                
            }
        );
        
        var renderFacet = {};
        renderFacet['tag'] = [
            {
                $project: {
                    tag: "$_id",
                    total: "$total",
                    
                }
            }
        ];

        if(pict == true)
        {
            renderFacet['pict'] = [
                {
                    $project: {
                        pict: "$posted"
                    }
                },
                {
                    $unwind: {
                        path: "$pict"
                    }
                },
                {
                    $match: {
                        "pict.postType": "pict"
                    }
                },
                {
                    $project: {
                        // tester: "$pict.mediaSource",
                        "isApsara": {
                            $arrayElemAt: ['$pict.mediaSource.apsara', 0]
                        },
                        "apsaraId": {
                            $arrayElemAt: ['$pict.mediaSource.apsaraId', 0]
                        },
                        "apsaraThumbId": {
                            $arrayElemAt: ['$pict.mediaSource.apsaraThumbId', 0]
                        },
                        "mediaEndpoint": {
                            "$concat": ["/pict/", "$pict.postID"]
                        },
                        "mediaUri": {
                            $arrayElemAt: ['$pict.mediaSource.mediaUri', 0]
                        },
                        "mediaThumbEndpoint": {
                            "$concat": ["/thumb/", "$pict.postID"]
                        },
                        "mediaThumbUri": {
                            $arrayElemAt: ['$pict.mediaSource.mediaThumUri', 0]
                        },
                        "mediaType": {
                            $arrayElemAt: ['$pict.mediaSource.mediaType', 0]
                        },
                        "scorePict": "$pict.scorePict",
                        "boosted": "$pict.boosted",
                        "reportedStatus": "$pict.reportedStatus",
                        "_id": "$pict._id",
                        "createdAt": "$pict.createdAt",
                        "updatedAt": "$pict.updatedAt",
                        "postID": "$pict.postID",
                        "email": "$pict.email",
                        "postType": "$pict.postType",
                        "description": "$pict.description",
                        "active": "$pict.active",
                        "metadata": "$pict.metadata",
                        "location": "$pict.location",
                        "isOwned": "$pict.isOwned",
                        "visibility": "$pict.visibility",
                        "isViewed": "$pict.isViewed",
                        "allowComments": "$pict.allowComments",
                        "saleAmount": "$pict.saleAmount",
                        "monetize": 
                        {
                            $cond: {
                                if : {
                                    $gte: ["$pict.saleAmount", 1]
                                },
                                then: true,
                                else : "$taslimKONAG"
                            }
                        },
                        "comments": "$pict.comments",
                        "likes": "$pict.likes",
                        "insight": 
                            {
                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                        },
                        
                    }
                },
                {
                    $sort: {
                        isApsara: - 1,
                        scorePict: - 1,
                        comments: - 1,
                        likes: - 1,
                        createdAt: - 1
                    }
                },
                {
                    $skip: (skip * limit)
                },
                {
                    $limit: limit
                }
            ];
        }

        if(vid == true)
        {
            renderFacet['vid'] = [
                {
                    $project: {
                        pict: "$posted"
                    }
                },
                {
                    $unwind: {
                        path: "$pict"
                    }
                },
                {
                    $match: {
                        "pict.postType": "vid"
                    }
                },
                {
                    $project: {
                        // tester: "$pict.mediaSource",
                        "isApsara": {
                            $arrayElemAt: ['$pict.mediaSource.apsara', 0]
                        },
                        "apsaraId": {
                            $arrayElemAt: ['$pict.mediaSource.apsaraId', 0]
                        },
                        "apsaraThumbId": {
                            $arrayElemAt: ['$pict.mediaSource.apsaraThumbId', 0]
                        },
                        "mediaEndpoint": {
                            "$concat": ["/stream/", "$pict.postID"]
                        },
                        "mediaUri": {
                            $arrayElemAt: ['$pict.mediaSource.mediaUri', 0]
                        },
                        "mediaThumbEndpoint": {
                            "$concat": ["/thumb/", "$pict.postID"]
                        },
                        "mediaThumbUri": {
                            $arrayElemAt: ['$pict.mediaSource.mediaThumUri', 0]
                        },
                        "mediaType": {
                            $arrayElemAt: ['$pict.mediaSource.mediaType', 0]
                        },
                        "scorePict": "$pict.scorePict",
                        "boosted": "$pict.boosted",
                        "reportedStatus": "$pict.reportedStatus",
                        "_id": "$pict._id",
                        "createdAt": "$pict.createdAt",
                        "updatedAt": "$pict.updatedAt",
                        "postID": "$pict.postID",
                        "email": "$pict.email",
                        "postType": "$pict.postType",
                        "description": "$pict.description",
                        "active": "$pict.active",
                        "metadata": "$pict.metadata",
                        "location": "$pict.location",
                        "isOwned": "$pict.isOwned",
                        "visibility": "$pict.visibility",
                        "isViewed": "$pict.isViewed",
                        "allowComments": "$pict.allowComments",
                        "saleAmount": "$pict.saleAmount",
                        "monetize": 
                        {
                            $cond: {
                                if : {
                                    $gte: ["$pict.saleAmount", 1]
                                },
                                then: true,
                                else : "$taslimKONAG"
                            }
                        },
                        "comments": "$pict.comments",
                        "likes": "$pict.likes",
                        "insight": 
                            {
                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                        },
                        
                    }
                },
                {
                    $sort: {
                        isApsara: - 1,
                        scorePict: - 1,
                        comments: - 1,
                        likes: - 1,
                        createdAt: - 1
                    }
                },
                {
                    $skip: (skip * limit)
                },
                {
                    $limit: limit
                }
            ];
        }

        if(diary == true)
        {
            renderFacet['diary'] = [
                {
                    $project: {
                        pict: "$posted"
                    }
                },
                {
                    $unwind: {
                        path: "$pict"
                    }
                },
                {
                    $match: {
                        "pict.postType": "diary"
                    }
                },
                {
                    $project: {
                        // tester: "$pict.mediaSource",
                        "isApsara": {
                            $arrayElemAt: ['$pict.mediaSource.apsara', 0]
                        },
                        "apsaraId": {
                            $arrayElemAt: ['$pict.mediaSource.apsaraId', 0]
                        },
                        "apsaraThumbId": {
                            $arrayElemAt: ['$pict.mediaSource.apsaraThumbId', 0]
                        },
                        "mediaEndpoint": {
                            "$concat": ["/stream/", "$pict.postID"]
                        },
                        "mediaUri": {
                            $arrayElemAt: ['$pict.mediaSource.mediaUri', 0]
                        },
                        "mediaThumbEndpoint": {
                            "$concat": ["/thumb/", "$pict.postID"]
                        },
                        "mediaThumbUri": {
                            $arrayElemAt: ['$pict.mediaSource.mediaThumUri', 0]
                        },
                        "mediaType": {
                            $arrayElemAt: ['$pict.mediaSource.mediaType', 0]
                        },
                        "scorePict": "$pict.scorePict",
                        "boosted": "$pict.boosted",
                        "reportedStatus": "$pict.reportedStatus",
                        "_id": "$pict._id",
                        "createdAt": "$pict.createdAt",
                        "updatedAt": "$pict.updatedAt",
                        "postID": "$pict.postID",
                        "email": "$pict.email",
                        "postType": "$pict.postType",
                        "description": "$pict.description",
                        "active": "$pict.active",
                        "metadata": "$pict.metadata",
                        "location": "$pict.location",
                        "isOwned": "$pict.isOwned",
                        "visibility": "$pict.visibility",
                        "isViewed": "$pict.isViewed",
                        "allowComments": "$pict.allowComments",
                        "saleAmount": "$pict.saleAmount",
                        "monetize": 
                        {
                            $cond: {
                                if : {
                                    $gte: ["$pict.saleAmount", 1]
                                },
                                then: true,
                                else : "$taslimKONAG"
                            }
                        },
                        "comments": "$pict.comments",
                        "likes": "$pict.likes",
                        "insight": 
                            {
                            $ifNull: ["$pict.insight", "$TaslimKAMPRET"]
                        },
                        
                    }
                },
                {
                    $sort: {
                        isApsara: - 1,
                        scorePict: - 1,
                        comments: - 1,
                        likes: - 1,
                        createdAt: - 1
                    }
                },
                {
                    $skip: (skip * limit)
                },
                {
                    $limit: limit
                }
            ];
        }

        pipeline.push(
            {
                "$facet":renderFacet
            }
        );

        // var util = require('util');
        // console.log(util.inspect(pipeline, { depth:null, showHidden:false }));

        var result = await this.tagcountModel.aggregate(pipeline);
        return result;
    }

    async detailsearchcontenNew4(key: string, email: string, skip: number, limit: number, pict: any, vid: any, diary: any) 
    {
        var pipeline = [];
        pipeline.push(
            {
                $match: {
                    "_id": key
                }
            },
            {
                $unwind: {
                    path: "$listdata",
                    preserveNullAndEmptyArrays: true
                }
            },
            {
                $skip: (skip * limit)
            },
            {
                $limit: 80 + (skip * limit)
            },
            {
                $group: {
                    _id: "$_id",
                    total: {
                        $last: "$total"
                    },
                    listdata: {
                        $push: "$listdata"
                    }
                }
            },
            {
                $lookup: {
                    from: "newPosts",
                    let: {
                        localID: "$listdata.postID"
                    },
                    pipeline: [
                        {
                            $match: 
                            {
                                $and: [
                                    {
                                        $expr: {
                                            $in: ['$postID', '$$localID']
                                        }
                                    },
                                    {
                                        "reportedStatus": {
                                            $ne: "OWNED"
                                        }
                                    },
                                    {
                                        "visibility": "PUBLIC"
                                    },
                                    {
                                        "active": true
                                    },
                                    {
                                        "reportedUser.email": {
                                            $not: {
                                                $regex: email
                                            }
                                        }
                                    },
                                    { 
                                        '$text': 
                                        { 
                                            '$search': key 
                                        } 
                                    }
                                ]
                            },
                            
                        },
                        {
                            $project: {
                                boosted: {
                                    $cond: {
                                      if: {
                                        $gt: [
                                          {
                                            $dateToString: {
                                              format: "%Y-%m-%d %H:%M:%S",
                                              date: {
                                                $add: [new Date(), 25200000],
                                              },
                                            },
                                          },
                                          "$boosted.boostSession.timeEnd",
                                        ],
                                      },
                                      then: [],
                                      else: "$boosted",
                                    },
                                },
                                reportedStatus: 1,
                                insight: {
                                    shares: "$shares",
                                    comments: "$comments",
                                    views: "$views",
                                    likes: "$likes",
                                },
                                comments: "$comments",
                                likes: "$likes",
                                scorePict: 
                                { 
                                    $meta: "textScore" 
                                },
                                _id: 1,
                                postID: 1,
                                createdAt: 1,
                                updatedAt: 1,
                                email: 1,
                                postType: 1,
                                description: 1,
                                active: 1,
                                metadata: 1,
                                musicId: 1,
                                views: 1,
                                location: 1,
                                tagPeople: {
                                    $ifNull: 
                                    [
                                        "$tagPeople", []
                                    ],
                                },
                                isOwned: 1,
                                visibility: 1,
                                isViewed: 1,
                                allowComments: 1,
                                saleAmount: 1,
                                userLike: 1,
                                userView: 1,
                                mediaSource: 1,
                                category: 1,
                                contentModeration: 1,
                                reportedUserCount: 1,
                                reportedUser: 1,
                                contentModerationResponse: 1,
                                tags: 1, 
                            }
                        }
                    ],
                    as: "posted"
                },
                
            }
        );

        var lookupBasicpipeline = [];
        lookupBasicpipeline.push();
        
        var renderFacet = {};
        renderFacet['tag'] = [
            {
                $project: {
                    tag: "$_id",
                    total: "$total",
                    
                }
            }
        ];

        if(pict == true)
        {
            renderFacet['pict'] = [
                { $project: { pict: "$posted" } },
                { $unwind: { path: "$pict" } },
                { $match: { "pict.postType": "pict" } },
                {
                    $project: {
                    // tester: "$pict.mediaSource",
                    apsara: { $arrayElemAt: ["$pict.mediaSource.apsara", 0] },
                    apsaraId: { $arrayElemAt: ["$pict.mediaSource.apsaraId", 0] },
                    apsaraThumbId: {
                        $arrayElemAt: ["$pict.mediaSource.apsaraThumbId", 0],
                    },
                    mediaEndpoint: { $concat: ["/pict/", "$pict.postID"] },
                    mediaUri: { $arrayElemAt: ["$pict.mediaSource.mediaUri", 0] },
                    uploadSource: { $arrayElemAt: ["$pict.mediaSource.uploadSource", 0] },
                    mediaThumbEndpoint: { $concat: ["/thumb/", "$pict.postID"] },
                    mediaThumbUri: {
                        $arrayElemAt: ["$pict.mediaSource.mediaThumUri", 0],
                    },
                    mediaType: { $arrayElemAt: ["$pict.mediaSource.mediaType", 0] },
                    scorePict: "$pict.scorePict",
                    boosted: "$pict.boosted",
                    _id: "$pict._id",
                    musicId: "$pict.musicId",
                    createdAt: "$pict.createdAt",
                    updatedAt: "$pict.updatedAt",
                    reportedStatus: "$pict.reportedStatus",
                    metadata: "$pict.metadata",
                    contentModeration: "$pict.contentModeration",
                    category: "$pict.category",
                    postID: "$pict.postID",
                    email: "$pict.email",
                    postType: "$pict.postType",
                    description: "$pict.description",
                    tags: "$pict.tags",
                    active: "$pict.active",
                    location: "$pict.location",
                    tagPeople: "$pict.tagPeople",
                    contentModerationResponse: "$pict.contentModerationResponse",
                    isOwned: "$pict.isOwned",
                    visibility: "$pict.visibility",
                    viewed: "$pict.views",
                    reportedUserCount: "$pict.reportedUserCount",
                    reportedUser: "$pict.reportedUser",
                    allowComments: "$pict.allowComments",
                    saleAmount: "$pict.saleAmount",
                    monetize: {
                        $cond: {
                        if: { $gte: ["$pict.saleAmount", 1] },
                        then: true,
                        else: "$taslimKONAG",
                        },
                    },
                    comments: "$pict.comments",
                    likes: "$pict.likes",
                    insight: { $ifNull: ["$pict.insight", "$TaslimKAMPRET"] },
                    isLiked: {
                        $ifNull: [
                        {
                            $filter: {
                            input: "$pict.userLike",
                            as: "likeList",
                            cond: {
                                $eq: ["$$likeList", email],
                            },
                            },
                        },
                        [],
                        ],
                    },
                    isViewed: {
                        $ifNull: [
                        {
                            $filter: {
                            input: "$pict.userView",
                            as: "viewList",
                            cond: {
                                $eq: ["$$viewList", email],
                            },
                            },
                        },
                        [],
                        ],
                    },
                    },
                },
                {
                    $sort: {
                    apsara: -1,
                    scorePict: -1,
                    comments: -1,
                    likes: -1,
                    createdAt: -1,
                    },
                },
                {
                    $skip: (skip * limit)
                },
                {
                    $limit: limit
                },
                {
                    $lookup: {
                      from: "newUserBasics",
                      as: "userBasic",
                      let: {
                        localID: "$email",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $eq: ["$email", "$$localID"],
                            },
                          },
                        },
                        {
                          $project: {
                            mediaBasePath: 1,
                            mediaUri: 1,
                            originalName: 1,
                            fsSourceUri: 1,
                            fsSourceName: 1,
                            fsTargetUri: 1,
                            mediaType: 1,
                            mediaEndpoint: 1,
                            fullName: 1,
                            profilePict: 1,
                            username:1,
                            isCelebrity: 1,
                            isIdVerified: 1,
                            isPrivate: 1,
                            isFollowPrivate: 1,
                            isPostPrivate: 1,
                            urluserBadge: {
                              $ifNull: [
                                {
                                  $filter: {
                                    input: "$userBadge",
                                    as: "listbadge",
                                    cond: {
                                      $and: [
                                        {
                                          $eq: ["$$listbadge.isActive", true],
                                        },
                                        {
                                          $lte: [
                                            {
                                              $dateToString: {
                                                format: "%Y-%m-%d %H:%M:%S",
                                                date: {
                                                  $add: [new Date(), 25200000],
                                                },
                                              },
                                            },
                                            "$$listbadge.endDatetime",
                                          ],
                                        },
                                      ],
                                    },
                                  },
                                },
                                [],
                              ],
                            },
                            following: [],
                            friend: [],
                            // following: {
                            //   $ifNull: [
                            //     {
                            //       $filter: {
                            //         input: "$follower",
                            //         as: "listuser",
                            //         cond: {
                            //           $eq: ["$$listuser", email],
                            //         },
                            //       },
                            //     },
                            //     [],
                            //   ],
                            // },
                            // friend: {
                            //   $ifNull: [
                            //     {
                            //       $filter: {
                            //         input: "$friend",
                            //         as: "listfriend",
                            //         cond: {
                            //           $eq: ["$$listfriend.email", email],
                            //         },
                            //       },
                            //     },
                            //     [],
                            //   ],
                            // },
                          },
                        },
                        {
                          $project: {
                            privacy: {
                              isCelebrity: "$isCelebrity",
                              isIdVerified: "$isIdVerified",
                              isPrivate: "$isPrivate",
                              isFollowPrivate: "$isFollowPrivate",
                              isPostPrivate: "$isPostPrivate",
                            },
                            avatar: {
                                mediaBasePath: "$mediaBasePath",
                                mediaUri: "$mediaUri",
                                originalName: "$originalName",
                                fsSourceUri: "$fsSourceUri",
                                fsSourceName: "$fsSourceName",
                                fsTargetUri: "$fsTargetUri",
                                mediaType: "$mediaType",
                                mediaEndpoint: "$mediaEndpoint",
                            },
                            fullName: 1,
                            username:1,
                            isCelebrity: 1,
                            verified: "$isIdVerified",
                            isPrivate: 1,
                            isFollowPrivate: 1,
                            isPostPrivate: 1,
                            urluserBadge: {
                              $ifNull: [
                                {
                                  $arrayElemAt: ["$urluserBadge", 0],
                                },
                                null,
                              ],
                            },
                            following: {
                              $cond: {
                                if: {
                                  $eq: [
                                    {
                                      $size: "$following",
                                    },
                                    0,
                                  ],
                                },
                                then: false,
                                else: true,
                              },
                            },
                            friend: {
                              $cond: {
                                if: {
                                  $eq: [
                                    {
                                      $size: "$friend",
                                    },
                                    0,
                                  ],
                                },
                                then: 0,
                                else: 1,
                              },
                            },
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "interests_repo",
                      as: "cats",
                      let: {
                        localID: "$category.$id",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $and: [
                                {
                                  $in: [
                                    "$_id",
                                    {
                                      $ifNull: ["$$localID", []],
                                    },
                                  ],
                                },
                              ],
                            },
                          },
                        },
                        {
                          $project: {
                            interestName: 1,
                            langIso: 1,
                            icon: 1,
                            createdAt: 1,
                            updatedAt: 1,
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "newUserBasics",
                      as: "userTag",
                      let: {
                        localID: "$tagPeople",
                      },
                      pipeline: [
                        {
                          $match: {
                            $or: [
                              {
                                $expr: {
                                  $in: ["$_id", "$$localID"],
                                },
                              },
                              {
                                $expr: {
                                  $in: ["$_idAuth", "$$localID"],
                                },
                              },
                            ],
                          },
                        },
                        {
                          $project: {
                            _id: 1,
                            username: 1,
                            fullName: 1,
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "mediamusic",
                      as: "music",
                      let: {
                        localID: "$musicId",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $eq: ["$_id", "$$localID"],
                            },
                          },
                        },
                        {
                          $lookup: {
                            from: "genre",
                            localField: "genre",
                            foreignField: "_id",
                            as: "genre_data",
                          },
                        },
                        {
                          $lookup: {
                            from: "theme",
                            localField: "theme",
                            foreignField: "_id",
                            as: "theme_data",
                          },
                        },
                        {
                          $lookup: {
                            from: "mood",
                            localField: "mood",
                            foreignField: "_id",
                            as: "mood_data",
                          },
                        },
                        {
                          $unwind: {
                            path: "$genre_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $unwind: {
                            path: "$theme_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $unwind: {
                            path: "$mood_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $project: {
                            musicTitle: 1,
                            artistName: 1,
                            albumName: 1,
                            apsaraMusic: 1,
                            apsaraThumnail: 1,
                            genre: "$genre_data.name",
                            theme: "$theme_data.name",
                            mood: "$mood_data.name",
                          },
                        },
                      ],
                    },
                  },
                  {
                    $unwind: {
                      path: "$music",
                      preserveNullAndEmptyArrays: true,
                    },
                  },
                  {
                    $unwind: {
                      path: "$userBasic",
                      preserveNullAndEmptyArrays: true,
                    },
                  },
                  {
                    $project: {
                      scorePict: 1,
                      boosted: 1,
                      reportedStatus: 1,
                      _id: 1,
                      mediaThumbEndpoint: 1,
                      mediaEndpoint: 1,
                      mediaType: 1,
                      createdAt: 1,
                      updatedAt: 1,
                      postID: 1,
                      email: 1,
                      postType: 1,
                      description: 1,
                      active: 1,
                      metadata: 1,
                      location: 1,
                      isOwned: 1,
                      visibility: 1,
                      apsaraThumbId: 1,
                      fullName: "$userBasic.fullName",
                      username: "$userBasic.username",
                      avatar: "$userBasic.avatar",
                      privacy: "$userBasic.privacy",
                      verified: "$userBasic.verified",
                      friend: "$userBasic.friend",
                      following: "$userBasic.following",
                      musicTitle: "$music.musicTitle",
                      artistName: "$music.artistName",
                      albumName: "$music.albumName",
                      apsaraMusic: "$music.apsaraMusic",
                      apsaraThumnail: "$music.apsaraThumnail",
                      genre: "$music.genre",
                      theme: "$music.theme",
                      mood: "$music.mood",
                      musicId: 1,
                      tagPeople: "$userTag",
                      urluserBadge: {
                        $ifNull: [
                          {
                            $arrayElemAt: ["$userBasic.urluserBadge", 0],
                          },
                          null,
                        ],
                      },
                      isViewed: {
                        $cond: {
                          if: {
                            $eq: [
                              {
                                $size: "$isViewed",
                              },
                              0,
                            ],
                          },
                          then: false,
                          else: true,
                        },
                      },
                      isLiked: {
                        $cond: {
                          if: {
                            $eq: [
                              {
                                $size: "$isLiked",
                              },
                              0,
                            ],
                          },
                          then: false,
                          else: true,
                        },
                      },
                      allowComments: 1,
                      saleAmount: 1,
                      uploadSource: 1,
                      monetize: 1,
                      comments: 1,
                      likes: 1,
                      viewed: 1,
                      insight: 1,
                      apsaraId: {
                        $ifNull: ["$apsaraId", null],
                      },
                      isApsara: {
                        $ifNull: ["$apsara", false],
                      },
                      contentModeration: 1,
                      reportedUserCount: 1,
                      contentModerationResponse: 1,
                      reportedUser: 1,
                      tags: 1,
                      cats: 1,
                    },
                },
            ];
        }

        if(vid == true)
        {
            renderFacet['vid'] = [
                { $project: { pict: "$posted" } },
                { $unwind: { path: "$pict" } },
                { $match: { "pict.postType": "vid" } },
                {
                    $project: {
                    // tester: "$pict.mediaSource",
                    apsara: { $arrayElemAt: ["$pict.mediaSource.apsara", 0] },
                    apsaraId: { $arrayElemAt: ["$pict.mediaSource.apsaraId", 0] },
                    apsaraThumbId: {
                        $arrayElemAt: ["$pict.mediaSource.apsaraThumbId", 0],
                    },
                    mediaEndpoint: { $concat: ["/stream/", "$pict.postID"] },
                    mediaUri: { $arrayElemAt: ["$pict.mediaSource.mediaUri", 0] },
                    mediaThumbEndpoint: { $concat: ["/thumb/", "$pict.postID"] },
                    mediaThumbUri: {
                        $arrayElemAt: ["$pict.mediaSource.mediaThumUri", 0],
                    },
                    uploadSource: { $arrayElemAt: ["$pict.mediaSource.uploadSource", 0] },
                    mediaType: { $arrayElemAt: ["$pict.mediaSource.mediaType", 0] },
                    scorePict: "$pict.scorePict",
                    boosted: "$pict.boosted",
                    _id: "$pict._id",
                    musicId: "$pict.musicId",
                    createdAt: "$pict.createdAt",
                    updatedAt: "$pict.updatedAt",
                    reportedStatus: "$pict.reportedStatus",
                    metadata: "$pict.metadata",
                    contentModeration: "$pict.contentModeration",
                    category: "$pict.category",
                    postID: "$pict.postID",
                    email: "$pict.email",
                    postType: "$pict.postType",
                    description: "$pict.description",
                    tags: "$pict.tags",
                    active: "$pict.active",
                    location: "$pict.location",
                    tagPeople: "$pict.tagPeople",
                    contentModerationResponse: "$pict.contentModerationResponse",
                    isOwned: "$pict.isOwned",
                    visibility: "$pict.visibility",
                    viewed: "$pict.views",
                    reportedUserCount: "$pict.reportedUserCount",
                    reportedUser: "$pict.reportedUser",
                    allowComments: "$pict.allowComments",
                    saleAmount: "$pict.saleAmount",
                    monetize: {
                        $cond: {
                        if: { $gte: ["$pict.saleAmount", 1] },
                        then: true,
                        else: "$taslimKONAG",
                        },
                    },
                    comments: "$pict.comments",
                    likes: "$pict.likes",
                    insight: { $ifNull: ["$pict.insight", "$TaslimKAMPRET"] },
                    isLiked: {
                        $ifNull: [
                        {
                            $filter: {
                            input: "$pict.userLike",
                            as: "likeList",
                            cond: {
                                $eq: ["$$likeList", email],
                            },
                            },
                        },
                        [],
                        ],
                    },
                    isViewed: {
                        $ifNull: [
                        {
                            $filter: {
                            input: "$pict.userView",
                            as: "viewList",
                            cond: {
                                $eq: ["$$viewList", email],
                            },
                            },
                        },
                        [],
                        ],
                    },
                    },
                },
                {
                    $sort: {
                    apsara: -1,
                    scorePict: -1,
                    comments: -1,
                    likes: -1,
                    createdAt: -1,
                    },
                },
                {
                    $skip: (skip * limit)
                },
                {
                    $limit: limit
                },
                {
                    $lookup: {
                      from: "newUserBasics",
                      as: "userBasic",
                      let: {
                        localID: "$email",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $eq: ["$email", "$$localID"],
                            },
                          },
                        },
                        {
                          $project: {
                            mediaBasePath: 1,
                            mediaUri: 1,
                            originalName: 1,
                            fsSourceUri: 1,
                            fsSourceName: 1,
                            fsTargetUri: 1,
                            mediaType: 1,
                            mediaEndpoint: 1,
                            fullName: 1,
                            username:1,
                            profilePict: 1,
                            isCelebrity: 1,
                            isIdVerified: 1,
                            isPrivate: 1,
                            isFollowPrivate: 1,
                            isPostPrivate: 1,
                            urluserBadge: {
                              $ifNull: [
                                {
                                  $filter: {
                                    input: "$userBadge",
                                    as: "listbadge",
                                    cond: {
                                      $and: [
                                        {
                                          $eq: ["$$listbadge.isActive", true],
                                        },
                                        {
                                          $lte: [
                                            {
                                              $dateToString: {
                                                format: "%Y-%m-%d %H:%M:%S",
                                                date: {
                                                  $add: [new Date(), 25200000],
                                                },
                                              },
                                            },
                                            "$$listbadge.endDatetime",
                                          ],
                                        },
                                      ],
                                    },
                                  },
                                },
                                [],
                              ],
                            },
                            following: [],
                            friend: [],
                            // following: {
                            //   $ifNull: [
                            //     {
                            //       $filter: {
                            //         input: "$follower",
                            //         as: "listuser",
                            //         cond: {
                            //           $eq: ["$$listuser", email],
                            //         },
                            //       },
                            //     },
                            //     [],
                            //   ],
                            // },
                            // friend: {
                            //   $ifNull: [
                            //     {
                            //       $filter: {
                            //         input: "$friend",
                            //         as: "listfriend",
                            //         cond: {
                            //           $eq: ["$$listfriend.email", email],
                            //         },
                            //       },
                            //     },
                            //     [],
                            //   ],
                            // },
                          },
                        },
                        {
                          $project: {
                            privacy: {
                              isCelebrity: "$isCelebrity",
                              isIdVerified: "$isIdVerified",
                              isPrivate: "$isPrivate",
                              isFollowPrivate: "$isFollowPrivate",
                              isPostPrivate: "$isPostPrivate",
                            },
                            avatar: {
                                mediaBasePath: "$mediaBasePath",
                                mediaUri: "$mediaUri",
                                originalName: "$originalName",
                                fsSourceUri: "$fsSourceUri",
                                fsSourceName: "$fsSourceName",
                                fsTargetUri: "$fsTargetUri",
                                mediaType: "$mediaType",
                                mediaEndpoint: "$mediaEndpoint",
                            },
                            fullName: 1,
                            isCelebrity: 1,
                            verified: "$isIdVerified",
                            isPrivate: 1,
                            isFollowPrivate: 1,
                            username:1,
                            isPostPrivate: 1,
                            urluserBadge: {
                              $ifNull: [
                                {
                                  $arrayElemAt: ["$urluserBadge", 0],
                                },
                                null,
                              ],
                            },
                            following: {
                                $cond: {
                                  if: {
                                    $eq: [
                                      {
                                        $size: "$following",
                                      },
                                      0,
                                    ],
                                  },
                                  then: false,
                                  else: true,
                                },
                            },
                            friend: {
                                $cond: {
                                  if: {
                                    $eq: [
                                      {
                                        $size: "$friend",
                                      },
                                      0,
                                    ],
                                  },
                                  then: 0,
                                  else: 1,
                                },
                            },
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "interests_repo",
                      as: "cats",
                      let: {
                        localID: "$category.$id",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $and: [
                                {
                                  $in: [
                                    "$_id",
                                    {
                                      $ifNull: ["$$localID", []],
                                    },
                                  ],
                                },
                              ],
                            },
                          },
                        },
                        {
                          $project: {
                            interestName: 1,
                            langIso: 1,
                            icon: 1,
                            createdAt: 1,
                            updatedAt: 1,
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "newUserBasics",
                      as: "userTag",
                      let: {
                        localID: "$tagPeople",
                      },
                      pipeline: [
                        {
                          $match: {
                            $or: [
                              {
                                $expr: {
                                  $in: ["$_id", "$$localID"],
                                },
                              },
                              {
                                $expr: {
                                  $in: ["$_idAuth", "$$localID"],
                                },
                              },
                            ],
                          },
                        },
                        {
                          $project: {
                            _id: 1,
                            username: 1,
                            fullName: 1,
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "mediamusic",
                      as: "music",
                      let: {
                        localID: "$musicId",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $eq: ["$_id", "$$localID"],
                            },
                          },
                        },
                        {
                          $lookup: {
                            from: "genre",
                            localField: "genre",
                            foreignField: "_id",
                            as: "genre_data",
                          },
                        },
                        {
                          $lookup: {
                            from: "theme",
                            localField: "theme",
                            foreignField: "_id",
                            as: "theme_data",
                          },
                        },
                        {
                          $lookup: {
                            from: "mood",
                            localField: "mood",
                            foreignField: "_id",
                            as: "mood_data",
                          },
                        },
                        {
                          $unwind: {
                            path: "$genre_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $unwind: {
                            path: "$theme_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $unwind: {
                            path: "$mood_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $project: {
                            musicTitle: 1,
                            artistName: 1,
                            albumName: 1,
                            apsaraMusic: 1,
                            apsaraThumnail: 1,
                            genre: "$genre_data.name",
                            theme: "$theme_data.name",
                            mood: "$mood_data.name",
                          },
                        },
                      ],
                    },
                  },
                  {
                    $unwind: {
                      path: "$music",
                      preserveNullAndEmptyArrays: true,
                    },
                  },
                  {
                    $unwind: {
                      path: "$userBasic",
                      preserveNullAndEmptyArrays: true,
                    },
                  },
                  {
                    $project: {
                      scorePict: 1,
                      boosted: 1,
                      reportedStatus: 1,
                      _id: 1,
                      mediaThumbEndpoint: 1,
                      mediaEndpoint: 1,
                      mediaType: 1,
                      createdAt: 1,
                      updatedAt: 1,
                      postID: 1,
                      email: 1,
                      postType: 1,
                      description: 1,
                      active: 1,
                      metadata: 1,
                      location: 1,
                      isOwned: 1,
                      visibility: 1,
                      apsaraThumbId: 1,
                      fullName: "$userBasic.fullName",
                      username: "$userBasic.username",
                      avatar: "$userBasic.avatar",
                      privacy: "$userBasic.privacy",
                      verified: "$userBasic.verified",
                      musicTitle: "$music.musicTitle",
                      artistName: "$music.artistName",
                      albumName: "$music.albumName",
                      apsaraMusic: "$music.apsaraMusic",
                      apsaraThumnail: "$music.apsaraThumnail",
                      genre: "$music.genre",
                      theme: "$music.theme",
                      mood: "$music.mood",
                      musicId: 1,
                      tagPeople: "$userTag",
                      urluserBadge: {
                        $ifNull: [
                          {
                            $arrayElemAt: ["$userBasic.urluserBadge", 0],
                          },
                          null,
                        ],
                      },
                      isViewed: {
                        $cond: {
                          if: {
                            $eq: [
                              {
                                $size: "$isViewed",
                              },
                              0,
                            ],
                          },
                          then: false,
                          else: true,
                        },
                      },
                      isLiked: {
                        $cond: {
                          if: {
                            $eq: [
                              {
                                $size: "$isLiked",
                              },
                              0,
                            ],
                          },
                          then: false,
                          else: true,
                        },
                      },
                      allowComments: 1,
                      saleAmount: 1,
                      uploadSource: 1,
                      monetize: 1,
                      comments: 1,
                      likes: 1,
                      viewed: 1,
                      insight: 1,
                      apsaraId: {
                        $ifNull: ["$apsaraId", null],
                      },
                      isApsara: {
                        $ifNull: ["$apsara", false],
                      },
                      contentModeration: 1,
                      reportedUserCount: 1,
                      contentModerationResponse: 1,
                      reportedUser: 1,
                      tags: 1,
                      cats: 1,
                    },
                },
            ];
        }

        if(diary == true)
        {
            renderFacet['diary'] = [
                { $project: { pict: "$posted" } },
                { $unwind: { path: "$pict" } },
                { $match: { "pict.postType": "diary" } },
                {
                    $project: {
                    // tester: "$pict.mediaSource",
                    apsara: { $arrayElemAt: ["$pict.mediaSource.apsara", 0] },
                    apsaraId: { $arrayElemAt: ["$pict.mediaSource.apsaraId", 0] },
                    apsaraThumbId: {
                        $arrayElemAt: ["$pict.mediaSource.apsaraThumbId", 0],
                    },
                    mediaEndpoint: { $concat: ["/stream/", "$pict.postID"] },
                    mediaUri: { $arrayElemAt: ["$pict.mediaSource.mediaUri", 0] },
                    mediaThumbEndpoint: { $concat: ["/thumb/", "$pict.postID"] },
                    mediaThumbUri: {
                        $arrayElemAt: ["$pict.mediaSource.mediaThumUri", 0],
                    },
                    uploadSource: { $arrayElemAt: ["$pict.mediaSource.uploadSource", 0] },
                    mediaType: { $arrayElemAt: ["$pict.mediaSource.mediaType", 0] },
                    scorePict: "$pict.scorePict",
                    boosted: "$pict.boosted",
                    _id: "$pict._id",
                    musicId: "$pict.musicId",
                    createdAt: "$pict.createdAt",
                    updatedAt: "$pict.updatedAt",
                    reportedStatus: "$pict.reportedStatus",
                    metadata: "$pict.metadata",
                    contentModeration: "$pict.contentModeration",
                    category: "$pict.category",
                    postID: "$pict.postID",
                    email: "$pict.email",
                    postType: "$pict.postType",
                    description: "$pict.description",
                    tags: "$pict.tags",
                    active: "$pict.active",
                    location: "$pict.location",
                    tagPeople: "$pict.tagPeople",
                    contentModerationResponse: "$pict.contentModerationResponse",
                    isOwned: "$pict.isOwned",
                    visibility: "$pict.visibility",
                    viewed: "$pict.views",
                    reportedUserCount: "$pict.reportedUserCount",
                    reportedUser: "$pict.reportedUser",
                    allowComments: "$pict.allowComments",
                    saleAmount: "$pict.saleAmount",
                    monetize: {
                        $cond: {
                        if: { $gte: ["$pict.saleAmount", 1] },
                        then: true,
                        else: "$taslimKONAG",
                        },
                    },
                    comments: "$pict.comments",
                    likes: "$pict.likes",
                    insight: { $ifNull: ["$pict.insight", "$TaslimKAMPRET"] },
                    isLiked: {
                        $ifNull: [
                        {
                            $filter: {
                            input: "$pict.userLike",
                            as: "likeList",
                            cond: {
                                $eq: ["$$likeList", email],
                            },
                            },
                        },
                        [],
                        ],
                    },
                    isViewed: {
                        $ifNull: [
                        {
                            $filter: {
                            input: "$pict.userView",
                            as: "viewList",
                            cond: {
                                $eq: ["$$viewList", email],
                            },
                            },
                        },
                        [],
                        ],
                    },
                    },
                },
                {
                    $sort: {
                    apsara: -1,
                    scorePict: -1,
                    comments: -1,
                    likes: -1,
                    createdAt: -1,
                    },
                },
                {
                    $skip: (skip * limit)
                },
                {
                    $limit: limit
                },
                {
                    $lookup: {
                      from: "newUserBasics",
                      as: "userBasic",
                      let: {
                        localID: "$email",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $eq: ["$email", "$$localID"],
                            },
                          },
                        },
                        {
                          $project: {
                            mediaBasePath: 1,
                            mediaUri: 1,
                            originalName: 1,
                            fsSourceUri: 1,
                            fsSourceName: 1,
                            fsTargetUri: 1,
                            mediaType: 1,
                            mediaEndpoint: 1,
                            fullName: 1,
                            profilePict: 1,
                            isCelebrity: 1,
                            isIdVerified: 1,
                            username:1,
                            isPrivate: 1,
                            isFollowPrivate: 1,
                            isPostPrivate: 1,
                            urluserBadge: {
                              $ifNull: [
                                {
                                  $filter: {
                                    input: "$userBadge",
                                    as: "listbadge",
                                    cond: {
                                      $and: [
                                        {
                                          $eq: ["$$listbadge.isActive", true],
                                        },
                                        {
                                          $lte: [
                                            {
                                              $dateToString: {
                                                format: "%Y-%m-%d %H:%M:%S",
                                                date: {
                                                  $add: [new Date(), 25200000],
                                                },
                                              },
                                            },
                                            "$$listbadge.endDatetime",
                                          ],
                                        },
                                      ],
                                    },
                                  },
                                },
                                [],
                              ],
                            },
                            // following: {
                            //   $ifNull: [
                            //     {
                            //       $filter: {
                            //         input: "$follower",
                            //         as: "listuser",
                            //         cond: {
                            //           $eq: ["$$listuser", email],
                            //         },
                            //       },
                            //     },
                            //     [],
                            //   ],
                            // },
                            following: [],
                            friend: [],
                            // following: {
                            //   $ifNull: [
                            //     {
                            //       $filter: {
                            //         input: "$follower",
                            //         as: "listuser",
                            //         cond: {
                            //           $eq: ["$$listuser", email],
                            //         },
                            //       },
                            //     },
                            //     [],
                            //   ],
                            // },
                            // friend: {
                            //   $ifNull: [
                            //     {
                            //       $filter: {
                            //         input: "$friend",
                            //         as: "listfriend",
                            //         cond: {
                            //           $eq: ["$$listfriend.email", email],
                            //         },
                            //       },
                            //     },
                            //     [],
                            //   ],
                            // },
                          },
                        },
                        {
                          $project: {
                            privacy: {
                              isCelebrity: "$isCelebrity",
                              isIdVerified: "$isIdVerified",
                              isPrivate: "$isPrivate",
                              isFollowPrivate: "$isFollowPrivate",
                              isPostPrivate: "$isPostPrivate",
                            },
                            avatar: {
                              mediaBasePath: "$mediaBasePath",
                              mediaUri: "$mediaUri",
                              originalName: "$originalName",
                              fsSourceUri: "$fsSourceUri",
                              fsSourceName: "$fsSourceName",
                              fsTargetUri: "$fsTargetUri",
                              mediaType: "$mediaType",
                              mediaEndpoint: "$mediaEndpoint",
                            },
                            fullName: 1,
                            username:1,
                            isCelebrity: 1,
                            verified: "$isIdVerified",
                            isPrivate: 1,
                            isFollowPrivate: 1,
                            isPostPrivate: 1,
                            urluserBadge: {
                              $ifNull: [
                                {
                                  $arrayElemAt: ["$urluserBadge", 0],
                                },
                                null,
                              ],
                            },
                            following: {
                                $cond: {
                                  if: {
                                    $eq: [
                                      {
                                        $size: "$following",
                                      },
                                      0,
                                    ],
                                  },
                                  then: false,
                                  else: true,
                                },
                            },
                            friend: {
                                $cond: {
                                  if: {
                                    $eq: [
                                      {
                                        $size: "$friend",
                                      },
                                      0,
                                    ],
                                  },
                                  then: 0,
                                  else: 1,
                                },
                            },
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "interests_repo",
                      as: "cats",
                      let: {
                        localID: "$category.$id",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $and: [
                                {
                                  $in: [
                                    "$_id",
                                    {
                                      $ifNull: ["$$localID", []],
                                    },
                                  ],
                                },
                              ],
                            },
                          },
                        },
                        {
                          $project: {
                            interestName: 1,
                            langIso: 1,
                            icon: 1,
                            createdAt: 1,
                            updatedAt: 1,
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "newUserBasics",
                      as: "userTag",
                      let: {
                        localID: "$tagPeople",
                      },
                      pipeline: [
                        {
                          $match: {
                            $or: [
                              {
                                $expr: {
                                  $in: ["$_id", "$$localID"],
                                },
                              },
                              {
                                $expr: {
                                  $in: ["$_idAuth", "$$localID"],
                                },
                              },
                            ],
                          },
                        },
                        {
                          $project: {
                            _id: 1,
                            username: 1,
                            fullName: 1,
                          },
                        },
                      ],
                    },
                  },
                  {
                    $lookup: {
                      from: "mediamusic",
                      as: "music",
                      let: {
                        localID: "$musicId",
                      },
                      pipeline: [
                        {
                          $match: {
                            $expr: {
                              $eq: ["$_id", "$$localID"],
                            },
                          },
                        },
                        {
                          $lookup: {
                            from: "genre",
                            localField: "genre",
                            foreignField: "_id",
                            as: "genre_data",
                          },
                        },
                        {
                          $lookup: {
                            from: "theme",
                            localField: "theme",
                            foreignField: "_id",
                            as: "theme_data",
                          },
                        },
                        {
                          $lookup: {
                            from: "mood",
                            localField: "mood",
                            foreignField: "_id",
                            as: "mood_data",
                          },
                        },
                        {
                          $unwind: {
                            path: "$genre_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $unwind: {
                            path: "$theme_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $unwind: {
                            path: "$mood_data",
                            preserveNullAndEmptyArrays: true,
                          },
                        },
                        {
                          $project: {
                            musicTitle: 1,
                            artistName: 1,
                            albumName: 1,
                            apsaraMusic: 1,
                            apsaraThumnail: 1,
                            genre: "$genre_data.name",
                            theme: "$theme_data.name",
                            mood: "$mood_data.name",
                          },
                        },
                      ],
                    },
                  },
                  {
                    $unwind: {
                      path: "$music",
                      preserveNullAndEmptyArrays: true,
                    },
                  },
                  {
                    $unwind: {
                      path: "$userBasic",
                      preserveNullAndEmptyArrays: true,
                    },
                  },
                  {
                    $project: {
                      scorePict: 1,
                      boosted: 1,
                      reportedStatus: 1,
                      _id: 1,
                      mediaThumbEndpoint: 1,
                      mediaEndpoint: 1,
                      mediaType: 1,
                      createdAt: 1,
                      updatedAt: 1,
                      postID: 1,
                      email: 1,
                      postType: 1,
                      description: 1,
                      active: 1,
                      metadata: 1,
                      location: 1,
                      isOwned: 1,
                      visibility: 1,
                      apsaraThumbId: 1,
                      fullName: "$userBasic.fullName",
                      username: "$userBasic.username",
                      avatar: "$userBasic.avatar",
                      privacy: "$userBasic.privacy",
                      verified: "$userBasic.verified",
                      musicTitle: "$music.musicTitle",
                      artistName: "$music.artistName",
                      albumName: "$music.albumName",
                      apsaraMusic: "$music.apsaraMusic",
                      apsaraThumnail: "$music.apsaraThumnail",
                      genre: "$music.genre",
                      theme: "$music.theme",
                      mood: "$music.mood",
                      musicId: 1,
                      tagPeople: "$userTag",
                      urluserBadge: {
                        $ifNull: [
                          {
                            $arrayElemAt: ["$userBasic.urluserBadge", 0],
                          },
                          null,
                        ],
                      },
                      isViewed: {
                        $cond: {
                          if: {
                            $eq: [
                              {
                                $size: "$isViewed",
                              },
                              0,
                            ],
                          },
                          then: false,
                          else: true,
                        },
                      },
                      isLiked: {
                        $cond: {
                          if: {
                            $eq: [
                              {
                                $size: "$isLiked",
                              },
                              0,
                            ],
                          },
                          then: false,
                          else: true,
                        },
                      },
                      allowComments: 1,
                      saleAmount: 1,
                      uploadSource: 1,
                      monetize: 1,
                      comments: 1,
                      likes: 1,
                      viewed: 1,
                      insight: 1,
                      apsaraId: {
                        $ifNull: ["$apsaraId", null],
                      },
                      isApsara: {
                        $ifNull: ["$apsara", false],
                      },
                      contentModeration: 1,
                      reportedUserCount: 1,
                      contentModerationResponse: 1,
                      reportedUser: 1,
                      tags: 1,
                      cats: 1,
                    },
                },
            ];
        }

        pipeline.push(
            {
                "$facet":renderFacet
            }
        );

        // var util = require('util');
        // console.log(util.inspect(pipeline, { depth:null, showHidden:false }));

        var result = await this.tagcountModel.aggregate(pipeline);
        return result;
    }
}
